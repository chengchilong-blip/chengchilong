<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>空间设计作品展示</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        /* 科技感网格背景 */
        body {
            font-family: 'Arial', sans-serif;
            background-color: #0a1128;
            background-image: 
                linear-gradient(rgba(255, 255, 255, 0.1) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255, 255, 255, 0.1) 1px, transparent 1px);
            background-size: 20px 20px;
            color: white;
            cursor: default;
        }
        
        /* 默认光标样式 */
        * {
            cursor: default;
        }
        
        /* 链接和按钮的光标样式 */
        a, button, .project-card {
            cursor: pointer;
        }
        
        /* 输入框光标效果增强 */
        input[type="text"] {
            caret-color: #00bfff;
            color: white;
            text-shadow: 0 0 8px rgba(0, 191, 255, 0.7);
        }
        
        /* 输入框获得焦点时的效果 */
        input[type="text"]:focus {
            outline: none;
            box-shadow: 0 0 20px rgba(0, 191, 255, 0.5) inset;
        }
        
        /* 全局文字颜色设置 */
        * {
            color: white !important;
        }
        
        .navbar {
            background-color: rgba(10, 17, 40, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .hero {
            background: linear-gradient(rgba(10, 17, 40, 0.9), rgba(10, 17, 40, 0.9)), url('https://images.unsplash.com/photo-1586023492125-27b2c045efd7?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80');
            background-size: cover;
            background-position: center;
            color: white;
            padding: 100px 0;
            position: relative;
            overflow: hidden;
        }
        
        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at center, rgba(0, 123, 255, 0.2) 0%, transparent 70%);
            pointer-events: none;
        }
        
        /* 项目卡片网格布局 */
        #projects-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            width: 100%;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        /* 响应式网格调整 */
        @media (max-width: 1200px) {
            #projects-container {
                grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
                gap: 18px;
            }
        }
        @media (max-width: 992px) {
            #projects-container {
                grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
                gap: 16px;
            }
        }
        @media (max-width: 768px) {
            #projects-container {
                grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
                gap: 15px;
            }
        }
        @media (max-width: 576px) {
            #projects-container {
                grid-template-columns: 1fr;
                gap: 15px;
            }
        }
        
        @media (min-width: 2000px) {
            #projects-container {
                grid-template-columns: repeat(5, 1fr);
                gap: 30px;
            }
        }
        
        .project-card {
            transition: all 0.3s ease;
            cursor: pointer;
            border-radius: 8px;
            overflow: hidden;
            background-color: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(5px);
            height: 100%;
            display: flex;
            flex-direction: column;
        }
        
        .project-card .card-body {
            flex-grow: 1;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .project-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 24px rgba(0, 123, 255, 0.3);
            border-color: rgba(0, 123, 255, 0.5);
        }
        
        /* 拖拽状态样式 */
        .project-card.dragging {
            opacity: 0.5;
            transform: rotate(5deg);
            z-index: 1000;
        }
        
        .project-image {
            aspect-ratio: 16/9;
            object-fit: cover;
            border-radius: 8px 8px 0 0;
            filter: brightness(0.8);
            transition: filter 0.3s ease;
        }
        
        .project-card:hover .project-image {
            filter: brightness(1);
        }
        
        .footer {
            background-color: rgba(10, 17, 40, 0.95);
            color: white;
            padding: 30px 0;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            margin-top: 50px;
        }
        
        .card-body {
            background-color: rgba(255, 255, 255, 0.05);
            border-radius: 0 0 8px 8px;
            color: white !important;
        }
        
        .card-title {
            font-weight: 400;
            font-size: 14px;
            color: white !important;
            text-shadow: 0 0 5px rgba(0, 191, 255, 0.5);
        }
        /* 相册网格显示模式样式 */
        #image-scroll-container {
            position: relative;
            height: 80vh;
            background-color: #000;
            overflow: auto;
        }
        /* 网格视图样式 */
        .grid-view {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            padding: 30px;
        }
        .grid-image-item {
            cursor: pointer;
            position: relative;
            overflow: hidden;
            border-radius: 8px;
            height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
        }
        .grid-image-item:hover {
            transform: scale(1.05);
        }
        .grid-image {
            height: 100%;
            max-width: 100%;
            object-fit: contain;
            transition: transform 0.3s ease;
        }
        .grid-image-item:hover .grid-image {
            transform: scale(1.1);
        }
        /* 单张查看模式样式 */
        .single-view {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100%;
            position: relative;
        }
        .main-image {
            max-width: 90%;
            max-height: 90%;
            object-fit: contain;
            transition: all 0.3s ease;
            cursor: zoom-in;
        }
        .main-image.zoomed {
            cursor: zoom-out;
        }
        .image-controls {
            position: absolute;
            bottom: 30px;
            left: 0;
            right: 0;
            display: flex;
            justify-content: center;
            gap: 20px;
        }
        .control-btn {
            padding: 10px 20px;
            background-color: rgba(0, 0, 0, 0.7);
            border: none;
            border-radius: 4px;
            color: white;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        .control-btn:hover {
            background-color: rgba(0, 0, 0, 0.9);
        }
        .image-info {
            position: absolute;
            top: 20px;
            left: 20px;
            color: white;
            background-color: rgba(0, 0, 0, 0.7);
            padding: 10px 15px;
            border-radius: 4px;
        }
        .scroll-controls {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }
        .scroll-btn {
            position: absolute;
            width: 50px;
            height: 50px;
            background-color: rgba(0, 0, 0, 0.5);
            border: none;
            border-radius: 50%;
            color: white;
            font-size: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            pointer-events: auto;
            transition: background-color 0.3s ease;
        }
        .scroll-btn:hover {
            background-color: rgba(0, 0, 0, 0.8);
        }
        .scroll-btn-up {
            top: 50px;
            left: 50%;
            transform: translateX(-50%);
        }
        .scroll-btn-down {
            bottom: 50px;
            left: 50%;
            transform: translateX(-50%);
        }
        /* 缩放控制按钮 */
        .zoom-controls {
            position: absolute;
            top: 120px;
            right: 30px;
            pointer-events: auto;
            z-index: 10;
        }
        .zoom-btn {
            display: block;
            width: 40px;
            height: 40px;
            background-color: rgba(0, 0, 0, 0.5);
            border: none;
            border-radius: 50%;
            color: white;
            font-size: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            margin-bottom: 10px;
            transition: background-color 0.3s ease;
        }
        .zoom-btn:hover {
            background-color: rgba(0, 0, 0, 0.8);
        }
        /* 加载动画样式 */
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .loading-spinner {
            width: 30px;
            height: 30px;
            border: 3px solid rgba(0, 191, 255, 0.2);
            border-top: 3px solid #00bfff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 10px;
            box-shadow: 0 0 15px rgba(0, 191, 255, 0.3);
        }
        
        /* 视图切换按钮 */
        .view-toggle {
            position: absolute;
            top: 30px;
            right: 30px;
            z-index: 10;
        }
        .toggle-btn {
            padding: 8px 16px;
            background-color: rgba(0, 191, 255, 0.1);
            border: 1px solid rgba(0, 191, 255, 0.3);
            border-radius: 4px;
            color: #00bfff;
            cursor: pointer;
            margin-left: 10px;
            transition: all 0.3s ease;
            box-shadow: 0 0 10px rgba(0, 191, 255, 0.2);
        }
        .toggle-btn:hover {
            background-color: rgba(0, 191, 255, 0.2);
            box-shadow: 0 0 15px rgba(0, 191, 255, 0.4);
        }
        .toggle-btn.active {
            background-color: rgba(0, 191, 255, 0.3);
            box-shadow: 0 0 20px rgba(0, 191, 255, 0.5);
        }
        
        /* 控制按钮样式 */
        .control-btn {
            padding: 10px 20px;
            background-color: rgba(0, 191, 255, 0.1);
            border: 1px solid rgba(0, 191, 255, 0.3);
            border-radius: 4px;
            color: #00bfff;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 0 10px rgba(0, 191, 255, 0.2);
        }
        .control-btn:hover {
            background-color: rgba(0, 191, 255, 0.2);
            box-shadow: 0 0 15px rgba(0, 191, 255, 0.4);
        }
        
        .scroll-btn {
            position: absolute;
            width: 50px;
            height: 50px;
            background-color: rgba(0, 191, 255, 0.1);
            border: 1px solid rgba(0, 191, 255, 0.3);
            border-radius: 50%;
            color: #00bfff;
            font-size: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            pointer-events: auto;
            transition: all 0.3s ease;
            box-shadow: 0 0 10px rgba(0, 191, 255, 0.2);
        }
        .scroll-btn:hover {
            background-color: rgba(0, 191, 255, 0.2);
            box-shadow: 0 0 15px rgba(0, 191, 255, 0.4);
        }
        
        .zoom-btn {
            display: block;
            width: 40px;
            height: 40px;
            background-color: rgba(0, 191, 255, 0.1);
            border: 1px solid rgba(0, 191, 255, 0.3);
            border-radius: 50%;
            color: #00bfff;
            font-size: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            margin-bottom: 10px;
            transition: all 0.3s ease;
            box-shadow: 0 0 10px rgba(0, 191, 255, 0.2);
        }
        .zoom-btn:hover {
            background-color: rgba(0, 191, 255, 0.2);
            box-shadow: 0 0 15px rgba(0, 191, 255, 0.4);
        }
        
        /* 图片容器样式 */
        .image-container {
            position: relative;
            width: 100%;
            height: 100%;
            overflow: hidden;
        }
        
        /* 图片信息样式 */
        .image-info {
            position: absolute;
            top: 20px;
            left: 20px;
            color: #00bfff;
            background-color: rgba(0, 191, 255, 0.1);
            padding: 10px 15px;
            border-radius: 4px;
            border: 1px solid rgba(0, 191, 255, 0.3);
            box-shadow: 0 0 10px rgba(0, 191, 255, 0.2);
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container">
            <a class="navbar-brand" href="#">空间设计作品展示</a>
        </div>
    </nav>

    <!-- 搜索区域 -->
    <section class="py-5" style="position: relative;">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-md-8">
                    <div class="input-group mb-3" style="border-radius: 4px; overflow: hidden; box-shadow: 0 0 20px rgba(0, 191, 255, 0.3); border: 1px solid rgba(0, 191, 255, 0.5); background-color: rgba(10, 17, 40, 0.8); backdrop-filter: blur(10px);">
                        <input type="text" class="form-control" placeholder="搜索项目..." id="search-input" style="border: none; padding: 15px 20px; font-size: 16px; background-color: transparent; color: white; box-shadow: none; caret-color: #00bfff; text-shadow: 0 0 5px rgba(0, 191, 255, 0.5);">
                        <button class="btn" onclick="searchProjects()" style="background-color: rgba(0, 191, 255, 0.2); border: none; padding: 0 30px; font-size: 16px; font-weight: 500; color: #00bfff; box-shadow: none;">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16">
                                <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
                            </svg>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="py-5">
        <div class="container">
            <div id="projects-container">
                <!-- 项目卡片将通过JavaScript动态生成 -->
            </div>
        </div>
    </section>



    <footer class="footer mt-5">
        <div class="container text-center">
            <p>&copy; 2024 空间设计作品展示</p>
        </div>
    </footer>

    <!-- 模态框 -->
    <div class="modal fade" id="projectModal" tabindex="-1" aria-labelledby="projectModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-fullscreen">
            <div class="modal-content" style="border: none; border-radius: 0; background-color: rgba(10, 17, 40, 0.95); backdrop-filter: blur(10px);">
                <div class="modal-header" style="background-color: rgba(0, 191, 255, 0.1); color: #00bfff; border: none; border-radius: 0; border-bottom: 1px solid rgba(0, 191, 255, 0.2);">
                    <h5 class="modal-title" id="projectModalLabel" style="font-weight: 600; text-shadow: 0 0 10px rgba(0, 191, 255, 0.5);">项目标题</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" style="filter: invert(1); opacity: 0.8; background-color: rgba(0, 191, 255, 0.1); border-radius: 4px;"></button>
                </div>
                <div class="modal-body p-0">
                    <div id="image-scroll-container">
                        <!-- 图片将通过JavaScript动态生成 -->
                    </div>
                    <div class="zoom-controls">
                        <button class="zoom-btn" onclick="zoomIn()">+</button>
                        <button class="zoom-btn" onclick="zoomOut()">-</button>
                        <button class="zoom-btn" onclick="resetZoom()">1:1</button>
                    </div>
                </div>
                <div class="modal-footer" style="background-color: rgba(0, 191, 255, 0.1); border: none; border-radius: 0; border-top: 1px solid rgba(0, 191, 255, 0.2);">
                    <button type="button" class="btn" data-bs-dismiss="modal" style="background-color: rgba(0, 191, 255, 0.2); color: #00bfff; font-weight: 500; border: 1px solid rgba(0, 191, 255, 0.5); box-shadow: 0 0 10px rgba(0, 191, 255, 0.3);">关闭</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // 项目数据
        let projects = [];
        // 项目图片数据
        const projectImages = {};

        // 初始化项目数据
        function initProjects() {
            // 清空现有项目数据
            projects = [];
            
            // 清空现有项目图片数据
            Object.keys(projectImages).forEach(key => {
                delete projectImages[key];
            });
            
            console.log('初始化项目数据...');
            
            // 尝试加载所有可能的项目目录
            const possibleProjectDirs = [
                '今日家园',
                '八宝山街道永东北社区',
                '古城泰然体育健康中心',
                '复兴路24号社区长廊',
                '平谷刑侦办公通道',
                '永定路东里社区',
                '海能环境办公室',
                '海能环境办公楼',
                '翠西楼道空间文化墙打造',
                '金沟河东路社区居委会文化',
                '万寿路28号社区',
                '万寿路街道党群服务中心门头',
                '中农健康科技',
                '中组部老干部活动站',
                '太平路22号院',
                '学院路街道办事处大件垃圾堆放处',
                '曙光街道世纪城西区社区会客议事厅',
                '曙光街道远大园社区',
                '永东南社区',
                '永定路街道新就业群体友好驿站',
                '玉泉西里北社区文化墙',
                '玉泉西里西社区党群服务中心',
                '石景山区委党校运动健康中心',
                '金雅园社区文化墙' // 新添加的项目
            ];

            // 为每个项目创建数据
            possibleProjectDirs.forEach(dirName => {
                // 创建项目对象
                const project = {
                    id: dirName,
                    title: dirName,
                    cover_image: null
                };

                projects.push(project);

                // 为项目添加图片数据
                projectImages[dirName] = [];

                // 对于海能环境办公室项目，直接指定实际存在的图片
                if (dirName === '海能环境办公室') {
                    project.cover_image = `${OSS_BASE_URL}海能环境办公室/1.png`;
                    projectImages[dirName] = [
                        `${OSS_BASE_URL}海能环境办公室/1.png`,
                        `${OSS_BASE_URL}海能环境办公室/2.png`,
                        `${OSS_BASE_URL}海能环境办公室/3.png`,
                        `${OSS_BASE_URL}海能环境办公室/休闲区.001.png`,
                        `${OSS_BASE_URL}海能环境办公室/休闲区.png`,
                        `${OSS_BASE_URL}海能环境办公室/入口.001.png`,
                        `${OSS_BASE_URL}海能环境办公室/入口.png`,
                        `${OSS_BASE_URL}海能环境办公室/大会议室.001.png`,
                        `${OSS_BASE_URL}海能环境办公室/大会议室.png`,
                        `${OSS_BASE_URL}海能环境办公室/小会议室.png`,
                        `${OSS_BASE_URL}海能环境办公室/接待室  2.png`,
                        `${OSS_BASE_URL}海能环境办公室/接待室.png`,
                        `${OSS_BASE_URL}海能环境办公室/节约.png`,
                        `${OSS_BASE_URL}海能环境办公室/走道.5.png`
                    ];
                }
                // 对于平谷刑侦办公通道项目
                else if (dirName === '平谷刑侦办公通道') {
                    project.cover_image = `${OSS_BASE_URL}平谷刑侦办公通道/一层.001.png`;
                    projectImages[dirName] = [
                        `${OSS_BASE_URL}平谷刑侦办公通道/一层.001.png`,
                        `${OSS_BASE_URL}平谷刑侦办公通道/一层.002.png`,
                        `${OSS_BASE_URL}平谷刑侦办公通道/一层.png`,
                        `${OSS_BASE_URL}平谷刑侦办公通道/一层防诈.png`,
                        `${OSS_BASE_URL}平谷刑侦办公通道/二层.001.png`,
                        `${OSS_BASE_URL}平谷刑侦办公通道/二层.002.png`,
                        `${OSS_BASE_URL}平谷刑侦办公通道/二层.003.png`,
                        `${OSS_BASE_URL}平谷刑侦办公通道/二层.004.png`,
                        `${OSS_BASE_URL}平谷刑侦办公通道/二层.005.png`,
                        `${OSS_BASE_URL}平谷刑侦办公通道/二层.006.png`,
                        `${OSS_BASE_URL}平谷刑侦办公通道/二层.007.png`,
                        `${OSS_BASE_URL}平谷刑侦办公通道/二层.008.png`,
                        `${OSS_BASE_URL}平谷刑侦办公通道/二层.009.png`,
                        `${OSS_BASE_URL}平谷刑侦办公通道/二层.010.png`,
                        `${OSS_BASE_URL}平谷刑侦办公通道/二层.011.png`,
                        `${OSS_BASE_URL}平谷刑侦办公通道/二层.012.png`,
                        `${OSS_BASE_URL}平谷刑侦办公通道/二层.013.png`,
                        `${OSS_BASE_URL}平谷刑侦办公通道/二层.014.png`,
                        `${OSS_BASE_URL}平谷刑侦办公通道/二层.015.png`,
                        `${OSS_BASE_URL}平谷刑侦办公通道/二层.016.png`,
                        `${OSS_BASE_URL}平谷刑侦办公通道/二层.png`,
                        `${OSS_BASE_URL}平谷刑侦办公通道/二层党建.001.png`,
                        `${OSS_BASE_URL}平谷刑侦办公通道/二层党建.002.png`,
                        `${OSS_BASE_URL}平谷刑侦办公通道/二层党建.003.png`,
                        `${OSS_BASE_URL}平谷刑侦办公通道/二层党建.004.png`,
                        `${OSS_BASE_URL}平谷刑侦办公通道/二层党建.005.png`,
                        `${OSS_BASE_URL}平谷刑侦办公通道/二层党建.006.png`,
                        `${OSS_BASE_URL}平谷刑侦办公通道/二层党建.007.png`,
                        `${OSS_BASE_URL}平谷刑侦办公通道/二层党建.png`,
                        `${OSS_BASE_URL}平谷刑侦办公通道/三层.001.png`,
                        `${OSS_BASE_URL}平谷刑侦办公通道/三层.002.png`,
                        `${OSS_BASE_URL}平谷刑侦办公通道/三层.003.png`,
                        `${OSS_BASE_URL}平谷刑侦办公通道/三层.004.png`,
                        `${OSS_BASE_URL}平谷刑侦办公通道/三层.005.png`,
                        `${OSS_BASE_URL}平谷刑侦办公通道/三层.006.png`,
                        `${OSS_BASE_URL}平谷刑侦办公通道/三层.007.png`,
                        `${OSS_BASE_URL}平谷刑侦办公通道/三层.png`,
                        `${OSS_BASE_URL}平谷刑侦办公通道/健身房.001.png`,
                        `${OSS_BASE_URL}平谷刑侦办公通道/健身房.002.png`,
                        `${OSS_BASE_URL}平谷刑侦办公通道/健身房.003.png`,
                        `${OSS_BASE_URL}平谷刑侦办公通道/健身房.png`,
                        `${OSS_BASE_URL}平谷刑侦办公通道/楼梯一.001.png`,
                        `${OSS_BASE_URL}平谷刑侦办公通道/楼梯一.002.png`,
                        `${OSS_BASE_URL}平谷刑侦办公通道/楼梯一.003.png`,
                        `${OSS_BASE_URL}平谷刑侦办公通道/楼梯一.004.png`,
                        `${OSS_BASE_URL}平谷刑侦办公通道/楼梯一.005.png`,
                        `${OSS_BASE_URL}平谷刑侦办公通道/楼梯一.006.png`,
                        `${OSS_BASE_URL}平谷刑侦办公通道/楼梯一.png`,
                        `${OSS_BASE_URL}平谷刑侦办公通道/楼梯二.001.png`,
                        `${OSS_BASE_URL}平谷刑侦办公通道/楼梯二.002.png`,
                        `${OSS_BASE_URL}平谷刑侦办公通道/楼梯二.003.png`,
                        `${OSS_BASE_URL}平谷刑侦办公通道/楼梯二.004.png`,
                        `${OSS_BASE_URL}平谷刑侦办公通道/楼梯二.005.png`,
                        `${OSS_BASE_URL}平谷刑侦办公通道/楼梯二.006.png`,
                        `${OSS_BASE_URL}平谷刑侦办公通道/楼梯二.png`
                    ];
                }
                // 对于永定路东里社区项目
                else if (dirName === '永定路东里社区') {
                    project.cover_image = `${OSS_BASE_URL}永定路东里社区/Camera.001.png`;
                    projectImages[dirName] = [
                        `${OSS_BASE_URL}永定路东里社区/Camera.001.png`,
                        `${OSS_BASE_URL}永定路东里社区/Camera.002.png`,
                        `${OSS_BASE_URL}永定路东里社区/Camera.003.png`,
                        `${OSS_BASE_URL}永定路东里社区/Camera.004.png`,
                        `${OSS_BASE_URL}永定路东里社区/Camera.png`
                    ];
                }
                // 对于翠西楼道空间文化墙打造项目
                else if (dirName === '翠西楼道空间文化墙打造') {
                    // 为翠西楼道空间文化墙打造项目设置实际图片
                    project.cover_image = `${OSS_BASE_URL}翠西楼道空间文化墙打造/image5.png`;
                    projectImages[dirName] = [
                        `${OSS_BASE_URL}翠西楼道空间文化墙打造/image3.png`,
                        `${OSS_BASE_URL}翠西楼道空间文化墙打造/image4.png`,
                        `${OSS_BASE_URL}翠西楼道空间文化墙打造/image5.png`,
                        `${OSS_BASE_URL}翠西楼道空间文化墙打造/image6.png`,
                        `${OSS_BASE_URL}翠西楼道空间文化墙打造/image7.png`,
                        `${OSS_BASE_URL}翠西楼道空间文化墙打造/image8.png`,
                        `${OSS_BASE_URL}翠西楼道空间文化墙打造/image9.png`,
                        `${OSS_BASE_URL}翠西楼道空间文化墙打造/image10.png`,
                        `${OSS_BASE_URL}翠西楼道空间文化墙打造/image11.png`
                    ];
                }
                // 对于八宝山街道永东北社区项目
                else if (dirName === '八宝山街道永东北社区') {
                    // 为八宝山街道项目设置实际图片
                    project.cover_image = `${OSS_BASE_URL}八宝山街道永东北社区/image5.png`;
                    projectImages[dirName] = [
                        `${OSS_BASE_URL}八宝山街道永东北社区/image4.png`,
                        `${OSS_BASE_URL}八宝山街道永东北社区/image5.png`,
                        `${OSS_BASE_URL}八宝山街道永东北社区/image6.png`,
                        `${OSS_BASE_URL}八宝山街道永东北社区/image7.png`,
                        `${OSS_BASE_URL}八宝山街道永东北社区/image8.png`,
                        `${OSS_BASE_URL}八宝山街道永东北社区/image9.png`,
                        `${OSS_BASE_URL}八宝山街道永东北社区/image10.png`,
                        `${OSS_BASE_URL}八宝山街道永东北社区/image11.png`,
                        `${OSS_BASE_URL}八宝山街道永东北社区/image12.png`
                    ];
                }
                // 对于今日家园项目
                else if (dirName === '今日家园') {
                    // 使用实际存在的图片作为封面
                    project.cover_image = `${OSS_BASE_URL}今日家园/image4.png`;
                    projectImages[dirName] = [
                        `${OSS_BASE_URL}今日家园/image4.png`,
                        `${OSS_BASE_URL}今日家园/image5.png`,
                        `${OSS_BASE_URL}今日家园/image6.png`,
                        `${OSS_BASE_URL}今日家园/image7.png`,
                        `${OSS_BASE_URL}今日家园/image8.png`,
                        `${OSS_BASE_URL}今日家园/image9.png`,
                        `${OSS_BASE_URL}今日家园/image10.png`,
                        `${OSS_BASE_URL}今日家园/image11.png`
                    ];
                }
                // 对于古城泰然体育健康中心项目
                else if (dirName === '古城泰然体育健康中心') {
                    // 使用实际存在的图片作为封面
                    project.cover_image = `${OSS_BASE_URL}古城泰然体育健康中心/image4.png`;
                    projectImages[dirName] = [
                        `${OSS_BASE_URL}古城泰然体育健康中心/image4.png`,
                        `${OSS_BASE_URL}古城泰然体育健康中心/image5.png`,
                        `${OSS_BASE_URL}古城泰然体育健康中心/image6.png`,
                        `${OSS_BASE_URL}古城泰然体育健康中心/image7.png`,
                        `${OSS_BASE_URL}古城泰然体育健康中心/image8.png`,
                        `${OSS_BASE_URL}古城泰然体育健康中心/image9.png`,
                        `${OSS_BASE_URL}古城泰然体育健康中心/image10.png`,
                        `${OSS_BASE_URL}古城泰然体育健康中心/image11.png`
                    ];
                }
                // 对于复兴路24号社区长廊项目
                else if (dirName === '复兴路24号社区长廊') {
                    // 使用实际存在的图片作为封面
                    project.cover_image = `${OSS_BASE_URL}复兴路24号社区长廊/image3.png`;
                    projectImages[dirName] = [
                        `${OSS_BASE_URL}复兴路24号社区长廊/image3.png`
                    ];
                }
                // 对于海能环境办公楼项目
                else if (dirName === '海能环境办公楼') {
                    // 使用实际存在的图片作为封面
                    project.cover_image = `${OSS_BASE_URL}海能环境办公楼/image11.png`;
                    projectImages[dirName] = [
                        `${OSS_BASE_URL}海能环境办公楼/image11.png`,
                        `${OSS_BASE_URL}海能环境办公楼/image12.png`,
                        `${OSS_BASE_URL}海能环境办公楼/image13.png`,
                        `${OSS_BASE_URL}海能环境办公楼/image16.png`,
                        `${OSS_BASE_URL}海能环境办公楼/image17.png`,
                        `${OSS_BASE_URL}海能环境办公楼/image19.png`,
                        `${OSS_BASE_URL}海能环境办公楼/image20.png`,
                        `${OSS_BASE_URL}海能环境办公楼/image22.png`,
                        `${OSS_BASE_URL}海能环境办公楼/image23.png`,
                        `${OSS_BASE_URL}海能环境办公楼/image24.png`,
                        `${OSS_BASE_URL}海能环境办公楼/image25.png`,
                        `${OSS_BASE_URL}海能环境办公楼/image26.png`,
                        `${OSS_BASE_URL}海能环境办公楼/image27.png`,
                        `${OSS_BASE_URL}海能环境办公楼/image28.png`,
                        `${OSS_BASE_URL}海能环境办公楼/image29.png`,
                        `${OSS_BASE_URL}海能环境办公楼/image30.png`,
                        `${OSS_BASE_URL}海能环境办公楼/image33.png`,
                        `${OSS_BASE_URL}海能环境办公楼/image7.png`
                    ];
                }
                // 对于金沟河东路社区居委会文化项目
                else if (dirName === '金沟河东路社区居委会文化') {
                    // 使用实际存在的图片作为封面
                    project.cover_image = `${OSS_BASE_URL}金沟河东路社区居委会文化/image3.png`;
                    projectImages[dirName] = [
                        `${OSS_BASE_URL}金沟河东路社区居委会文化/image3.png`,
                        `${OSS_BASE_URL}金沟河东路社区居委会文化/image4.png`,
                        `${OSS_BASE_URL}金沟河东路社区居委会文化/image5.png`,
                        `${OSS_BASE_URL}金沟河东路社区居委会文化/image6.png`
                    ];
                }
                // 对于万寿路28号社区项目
                else if (dirName === '万寿路28号社区') {
                    // 使用实际存在的图片路径
                    project.cover_image = `${OSS_BASE_URL}${dirName}/场景 10_3.png`;
                    projectImages[dirName] = [
                        `${OSS_BASE_URL}${dirName}/场景 10_3.png`,
                        `${OSS_BASE_URL}${dirName}/场景 11_3.png`,
                        `${OSS_BASE_URL}${dirName}/场景 12_2.png`,
                        `${OSS_BASE_URL}${dirName}/场景 13_2.png`,
                        `${OSS_BASE_URL}${dirName}/场景 14_2.png`
                    ];
                }
                // 对于中组部老干部活动站项目
                else if (dirName === '中组部老干部活动站') {
                    // 使用实际存在的图片作为封面
                    project.cover_image = `${OSS_BASE_URL}中组部老干部活动站/image2.jpeg`;
                    projectImages[dirName] = [
                        `${OSS_BASE_URL}中组部老干部活动站/image2.jpeg`,
                        `${OSS_BASE_URL}中组部老干部活动站/image6.jpeg`
                    ];
                }
                // 对于金雅园社区文化墙项目
                else if (dirName === '金雅园社区文化墙') {
                    // 使用实际存在的图片作为封面
                    project.cover_image = `${OSS_BASE_URL}金雅园社区文化墙/image3.png`;
                    projectImages[dirName] = [
                        `${OSS_BASE_URL}金雅园社区文化墙/image3.png`,
                        `${OSS_BASE_URL}金雅园社区文化墙/image4.png`,
                        `${OSS_BASE_URL}金雅园社区文化墙/image5.png`,
                        `${OSS_BASE_URL}金雅园社区文化墙/image6.png`,
                        `${OSS_BASE_URL}金雅园社区文化墙/image7.png`,
                        `${OSS_BASE_URL}金雅园社区文化墙/image8.png`,
                        `${OSS_BASE_URL}金雅园社区文化墙/image9.png`,
                        `${OSS_BASE_URL}金雅园社区文化墙/image10.png`,
                        `${OSS_BASE_URL}金雅园社区文化墙/image11.png`
                    ];
                }
                // 对于学院路街道办事处大件垃圾堆放处项目
                else if (dirName === '学院路街道办事处大件垃圾堆放处') {
                    // 使用实际存在的图片作为封面
                    project.cover_image = `${OSS_BASE_URL}学院路街道办事处大件垃圾堆放处/image3.png`;
                    projectImages[dirName] = [
                        `${OSS_BASE_URL}学院路街道办事处大件垃圾堆放处/image3.png`,
                        `${OSS_BASE_URL}学院路街道办事处大件垃圾堆放处/image5.png`,
                        `${OSS_BASE_URL}学院路街道办事处大件垃圾堆放处/image6.png`
                    ];
                }
                // 对于永东南社区项目
                else if (dirName === '永东南社区') {
                    // 使用实际存在的图片作为封面
                    project.cover_image = `${OSS_BASE_URL}永东南社区/image4.png`;
                    projectImages[dirName] = [
                        `${OSS_BASE_URL}永东南社区/image4.png`,
                        `${OSS_BASE_URL}永东南社区/image5.png`,
                        `${OSS_BASE_URL}永东南社区/image6.png`,
                        `${OSS_BASE_URL}永东南社区/image8.png`
                    ];
                }
                // 对于永定路街道新就业群体友好驿站项目
                else if (dirName === '永定路街道新就业群体友好驿站') {
                    // 使用实际存在的图片作为封面
                    project.cover_image = `${OSS_BASE_URL}永定路街道新就业群体友好驿站/image4.png`;
                    projectImages[dirName] = [
                        `${OSS_BASE_URL}永定路街道新就业群体友好驿站/image4.png`,
                        `${OSS_BASE_URL}永定路街道新就业群体友好驿站/image5.png`,
                        `${OSS_BASE_URL}永定路街道新就业群体友好驿站/image6.png`,
                        `${OSS_BASE_URL}永定路街道新就业群体友好驿站/image7.png`,
                        `${OSS_BASE_URL}永定路街道新就业群体友好驿站/image14.png`,
                        `${OSS_BASE_URL}永定路街道新就业群体友好驿站/image15.png`,
                        `${OSS_BASE_URL}永定路街道新就业群体友好驿站/image16.png`,
                        `${OSS_BASE_URL}永定路街道新就业群体友好驿站/image17.png`
                    ];
                }
                // 对于玉泉西里北社区文化墙项目
                else if (dirName === '玉泉西里北社区文化墙') {
                    // 使用实际存在的图片作为封面
                    project.cover_image = `${OSS_BASE_URL}玉泉西里北社区文化墙/image3.png`;
                    projectImages[dirName] = [
                        `${OSS_BASE_URL}玉泉西里北社区文化墙/image3.png`,
                        `${OSS_BASE_URL}玉泉西里北社区文化墙/image5.png`,
                        `${OSS_BASE_URL}玉泉西里北社区文化墙/image8.png`,
                        `${OSS_BASE_URL}玉泉西里北社区文化墙/image10.png`,
                        `${OSS_BASE_URL}玉泉西里北社区文化墙/image12.png`,
                        `${OSS_BASE_URL}玉泉西里北社区文化墙/image14.png`,
                        `${OSS_BASE_URL}玉泉西里北社区文化墙/image16.png`,
                        `${OSS_BASE_URL}玉泉西里北社区文化墙/image18.png`,
                        `${OSS_BASE_URL}玉泉西里北社区文化墙/image19.png`,
                        `${OSS_BASE_URL}玉泉西里北社区文化墙/image22.png`,
                        `${OSS_BASE_URL}玉泉西里北社区文化墙/image24.png`,
                        `${OSS_BASE_URL}玉泉西里北社区文化墙/image27.png`,
                        `${OSS_BASE_URL}玉泉西里北社区文化墙/image29.png`,
                        `${OSS_BASE_URL}玉泉西里北社区文化墙/image32.png`,
                        `${OSS_BASE_URL}玉泉西里北社区文化墙/image34.png`,
                        `${OSS_BASE_URL}玉泉西里北社区文化墙/image36.png`,
                        `${OSS_BASE_URL}玉泉西里北社区文化墙/image37.png`,
                        `${OSS_BASE_URL}玉泉西里北社区文化墙/image4.jpeg`,
                        `${OSS_BASE_URL}玉泉西里北社区文化墙/image41.png`,
                        `${OSS_BASE_URL}玉泉西里北社区文化墙/image43.png`,
                        `${OSS_BASE_URL}玉泉西里北社区文化墙/image44.png`,
                        `${OSS_BASE_URL}玉泉西里北社区文化墙/image46.png`
                    ];
                }
                // 对于其他项目，尝试多种图片命名格式
                else {
                    // 尝试不同的图片路径格式
                    const possibleFormats = [
                        `${OSS_BASE_URL}${dirName}/image1.png`,
                        `${OSS_BASE_URL}${dirName}/image2.png`,
                        `${OSS_BASE_URL}${dirName}/image3.png`,
                        `${OSS_BASE_URL}${dirName}/image4.png`,
                        `${OSS_BASE_URL}${dirName}/image5.png`,
                        `${OSS_BASE_URL}${dirName}/1.png`,
                        `${OSS_BASE_URL}${dirName}/场景 1.png`,
                        `${OSS_BASE_URL}${dirName}/场景 7_3.png`,
                        `${OSS_BASE_URL}${dirName}/场景 10_3.png`,
                        `${OSS_BASE_URL}${dirName}/Camera.001.png`,
                        `${OSS_BASE_URL}${dirName}/Camera.png`
                    ];
                    
                    // 尝试第一个可能的路径作为封面
                    project.cover_image = possibleFormats[0];
                    
                    // 添加多种可能的图片路径
                    projectImages[dirName] = possibleFormats;
                }
            });
        }

        // 刷新项目数据
        function refreshProjects() {
            initProjects();
            generateProjectCards();
        }
        
        // 页面加载完成后初始化项目数据
        window.onload = function() {
            refreshProjects();
            // 页面加载完成后添加拖拽排序功能
            setTimeout(() => {
                initDragAndDrop();
            }, 1000);
        };
        
        // 初始化拖拽排序功能
        function initDragAndDrop() {
            const container = document.getElementById('projects-container');
            if (!container) return;
            
            const cards = container.querySelectorAll('.project-card');
            
            cards.forEach(card => {
                // 添加拖拽开始事件
                card.addEventListener('dragstart', function(e) {
                    this.classList.add('dragging');
                    e.dataTransfer.setData('text/plain', this.getAttribute('data-project-id'));
                });
                
                // 添加拖拽结束事件
                card.addEventListener('dragend', function() {
                    this.classList.remove('dragging');
                });
            });
            
            // 添加容器的拖拽事件
            container.addEventListener('dragover', function(e) {
                e.preventDefault();
                const draggingCard = document.querySelector('.dragging');
                const siblings = [...this.querySelectorAll('.project-card:not(.dragging)')];
                
                const nextSibling = siblings.find(sibling => {
                    const rect = sibling.getBoundingClientRect();
                    const y = e.clientY - rect.top;
                    return y <= rect.height / 2;
                });
                
                if (nextSibling) {
                    this.insertBefore(draggingCard, nextSibling);
                } else {
                    this.appendChild(draggingCard);
                }
            });
            
            container.addEventListener('drop', function(e) {
                e.preventDefault();
                const draggedId = e.dataTransfer.getData('text/plain');
                const draggedCard = document.querySelector(`[data-project-id="${draggedId}"]`);
                if (draggedCard) {
                    // 保存排序结果
                    saveSortOrder();
                }
            });
        }
        
        // 保存排序结果到本地存储
        function saveSortOrder() {
            const container = document.getElementById('projects-container');
            if (!container) return;
            
            const cards = container.querySelectorAll('.project-card');
            const sortOrder = Array.from(cards).map(card => card.getAttribute('data-project-id'));
            
            localStorage.setItem('projectSortOrder', JSON.stringify(sortOrder));
            console.log('排序结果已保存:', sortOrder);
        }
        
        // 加载排序结果
        function loadSortOrder() {
            const container = document.getElementById('projects-container');
            if (!container) return;
            
            const savedOrder = localStorage.getItem('projectSortOrder');
            if (!savedOrder) return;
            
            const sortOrder = JSON.parse(savedOrder);
            const cards = container.querySelectorAll('.project-card');
            
            // 创建卡片映射
            const cardMap = {};
            cards.forEach(card => {
                const id = card.getAttribute('data-project-id');
                cardMap[id] = card;
            });
            
            // 按照保存的顺序重新排列卡片
            sortOrder.forEach(id => {
                if (cardMap[id]) {
                    container.appendChild(cardMap[id]);
                }
            });
            
            console.log('排序结果已加载:', sortOrder);
        }

        // 搜索项目
        function searchProjects() {
            const searchTerm = document.getElementById('search-input').value.toLowerCase().trim();
            
            // 过滤项目
            let filteredProjects = searchTerm ? 
                projects.filter(project => project.title.toLowerCase().includes(searchTerm)) : 
                projects;
            
            // 按搜索匹配度排序
            if (searchTerm) {
                filteredProjects.sort((a, b) => {
                    const aMatch = a.title.toLowerCase().indexOf(searchTerm);
                    const bMatch = b.title.toLowerCase().indexOf(searchTerm);
                    // 匹配位置越靠前，排序越靠前
                    if (aMatch !== bMatch) {
                        return aMatch - bMatch;
                    }
                    // 长度越短，排序越靠前
                    return a.title.length - b.title.length;
                });
            }
            
            // 更新项目卡片
            const container = document.getElementById('projects-container');
            container.innerHTML = '';
            
            if (filteredProjects.length === 0) {
                container.innerHTML = '<div style="grid-column: 1 / -1; text-align: center; padding: 40px;"><p>未找到匹配的项目</p></div>';
                return;
            }
            
            // 生成过滤后的项目卡片
            filteredProjects.forEach(project => {
                // 创建卡片元素
                const cardElement = document.createElement('div');
                cardElement.className = 'project-card';
                cardElement.setAttribute('data-project-id', project.id);
                
                // 创建图片元素
                const imgElement = document.createElement('img');
                imgElement.className = 'project-image';
                imgElement.alt = project.title;
                
                // 设置图片源并添加加载失败处理
                if (project.cover_image) {
                    imgElement.src = project.cover_image;
                    // 图片加载失败时显示占位符
                    imgElement.onerror = function() {
                        this.src = 'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="400" height="225"%3E%3Crect width="400" height="225" fill="rgba(0, 0, 0, 0.3)"/%3E%3Ctext x="200" y="112" text-anchor="middle" fill="rgba(255, 255, 255, 0.5)" font-size="14"%3E图片加载失败%3C/text%3E%3C/svg%3E';
                        this.style.opacity = '1';
                    };
                    // 图片加载成功时的处理
                    imgElement.onload = function() {
                        this.style.opacity = '1';
                    };
                } else {
                    imgElement.src = 'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="400" height="225"%3E%3Crect width="400" height="225" fill="rgba(0, 0, 0, 0.3)"/%3E%3Ctext x="200" y="112" text-anchor="middle" fill="rgba(255, 255, 255, 0.5)" font-size="14"%3E无图片%3C/text%3E%3C/svg%3E';
                    imgElement.style.opacity = '1';
                }
                
                // 创建卡片内容
                const cardBody = document.createElement('div');
                cardBody.className = 'card-body';
                
                const cardTitle = document.createElement('h5');
                cardTitle.className = 'card-title';
                cardTitle.textContent = project.title;
                
                // 组装卡片
                cardBody.appendChild(cardTitle);
                cardElement.appendChild(imgElement);
                cardElement.appendChild(cardBody);
                container.appendChild(cardElement);
            });
            
            // 添加点击事件
            document.querySelectorAll('.project-card').forEach(card => {
                card.addEventListener('click', function() {
                    const projectId = this.getAttribute('data-project-id');
                    showProjectDetails(projectId);
                });
            });
        }

        // 阿里云OSS基础路径
        const OSS_BASE_URL = 'https://chengchilong.oss-cn-wuhan-lr.aliyuncs.com/projects/';
        
        // 全局变量
        let currentPage = 1;
        const cardsPerPage = 50; // 每页显示50个卡片，确保一次性加载所有项目
        let isLoading = false;
        let isAllLoaded = false;
        let currentZoom = 1;
        let currentImage = null;
        let isDragging = false;
        let startX = 0;
        let startY = 0;
        let translateX = 0;
        let translateY = 0;
        let currentProjectId = null;
        let currentImageIndex = 0;
        let projectImagesList = [];
        let currentView = 'grid'; // 'grid' 或 'single'
        
        // 生成项目卡片（支持分页加载）
        function generateProjectCards() {
            const container = document.getElementById('projects-container');
            
            if (!container) {
                console.error('未找到projects-container元素');
                return;
            }
            
            if (projects.length === 0) {
                container.innerHTML = '<div style="grid-column: 1 / -1; text-align: center; padding: 40px;"><p>暂无作品，敬请期待</p></div>';
                return;
            }
            
            console.log('生成项目卡片...');
            console.log('项目总数:', projects.length);
            
            // 清空容器，重置状态
            container.innerHTML = '';
            currentPage = 1;
            isLoading = false;
            isAllLoaded = false;
            
            // 初始加载第一页
            loadNextPage();
        }
        
        // 处理滚动事件，实现无限滚动
        function handleScroll() {
            const container = document.getElementById('projects-container');
            if (!container) return;
            
            // 当滚动到底部时加载更多
            if (container.scrollTop + container.clientHeight >= container.scrollHeight - 100 && !isLoading && !isAllLoaded) {
                loadNextPage();
            }
        }
        
        // 加载下一页卡片
        function loadNextPage() {
            if (isLoading || isAllLoaded) return;
            
            isLoading = true;
            
            const container = document.getElementById('projects-container');
            if (!container) return;
            
            console.log('加载下一页卡片...');
            console.log('当前页码:', currentPage);
            console.log('项目总数:', projects.length);
            
            // 计算当前页的起始和结束索引
            const startIndex = (currentPage - 1) * cardsPerPage;
            const endIndex = Math.min(startIndex + cardsPerPage, projects.length);
            
            console.log('加载范围:', startIndex, '到', endIndex);
            
            // 如果已经加载完所有卡片
            if (startIndex >= projects.length) {
                console.log('所有卡片已加载完毕');
                isAllLoaded = true;
                return;
            }
            
            // 获取当前页的项目
            const pageProjects = projects.slice(startIndex, endIndex);
            console.log('当前页项目数量:', pageProjects.length);
            
            // 存储当前页的卡片元素
            const cardElements = [];
            
            // 创建当前页的卡片元素
            pageProjects.forEach(project => {
                // 创建卡片元素
                const cardElement = document.createElement('div');
                cardElement.className = 'project-card';
                cardElement.setAttribute('data-project-id', project.id);
                cardElement.style.opacity = '0';
                cardElement.style.transition = 'opacity 0.5s ease, transform 0.5s ease';
                cardElement.style.transform = 'translateY(20px)';
                // 添加拖拽属性
                cardElement.draggable = true;
                
                // 创建图片元素
                const imgElement = document.createElement('img');
                imgElement.className = 'project-image';
                imgElement.alt = project.title;
                imgElement.src = 'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="400" height="225"%3E%3Crect width="400" height="225" fill="rgba(0, 0, 0, 0.1)"/%3E%3C/svg%3E';
                imgElement.style.opacity = '0';
                imgElement.style.transition = 'opacity 0.5s ease';
                
                // 创建卡片内容
                const cardBody = document.createElement('div');
                cardBody.className = 'card-body';
                cardBody.style.opacity = '0';
                cardBody.style.transition = 'opacity 0.5s ease';
                
                const cardTitle = document.createElement('h5');
                cardTitle.className = 'card-title';
                cardTitle.textContent = project.title;
                
                // 组装卡片
                cardBody.appendChild(cardTitle);
                cardElement.appendChild(imgElement);
                cardElement.appendChild(cardBody);
                container.appendChild(cardElement);
                
                // 存储卡片元素和相关信息
                cardElements.push({
                    card: cardElement,
                    image: imgElement,
                    cardBody: cardBody,
                    project: project
                });
            });
            
            // 添加点击事件
            pageProjects.forEach((project, index) => {
                const card = cardElements[index].card;
                card.addEventListener('click', function() {
                    const projectId = this.getAttribute('data-project-id');
                    showProjectDetails(projectId);
                });
            });
            
            // 实现当前页卡片的顺序加载
            let currentLoadingIndex = 0;
            
            function loadNextCard() {
                if (currentLoadingIndex >= cardElements.length) {
                    // 当前页加载完成
                    currentPage++;
                    isLoading = false;
                    return;
                }
                
                const cardElement = cardElements[currentLoadingIndex];
                const { image, project, card, cardBody } = cardElement;
                
                // 卡片从下方滑入并逐渐显示
                card.style.opacity = '1';
                card.style.transform = 'translateY(0)';
                
                // 立即开始加载图片
                    if (project.cover_image) {
                        console.log('加载项目图片:', project.cover_image);
                        image.src = project.cover_image;
                        
                        // 图片加载完成后显示
                        image.onload = function() {
                            console.log('图片加载成功:', this.src);
                            this.style.opacity = '1';
                            cardBody.style.opacity = '1';
                        };
                        
                        // 图片加载失败的处理
                        image.onerror = function() {
                            console.log('图片加载失败:', this.src);
                            // 尝试其他可能的图片路径
                            const otherFormats = [
                                `${OSS_BASE_URL}${project.id}/image1.png`,
                                `${OSS_BASE_URL}${project.id}/image2.png`,
                                `${OSS_BASE_URL}${project.id}/image3.png`,
                                `${OSS_BASE_URL}${project.id}/image4.png`,
                                `${OSS_BASE_URL}${project.id}/image5.png`,
                                `${OSS_BASE_URL}${project.id}/image6.png`,
                                `${OSS_BASE_URL}${project.id}/image7.png`,
                                `${OSS_BASE_URL}${project.id}/image8.png`,
                                `${OSS_BASE_URL}${project.id}/image9.png`,
                                `${OSS_BASE_URL}${project.id}/image10.png`,
                                `${OSS_BASE_URL}${project.id}/1.png`,
                                `${OSS_BASE_URL}${project.id}/2.png`,
                                `${OSS_BASE_URL}${project.id}/3.png`,
                                `${OSS_BASE_URL}${project.id}/场景 1.png`,
                                `${OSS_BASE_URL}${project.id}/场景 7_3.png`,
                                `${OSS_BASE_URL}${project.id}/场景 10_3.png`,
                                `${OSS_BASE_URL}${project.id}/Camera.001.png`,
                                `${OSS_BASE_URL}${project.id}/Camera.002.png`,
                                `${OSS_BASE_URL}${project.id}/Camera.003.png`,
                                `${OSS_BASE_URL}${project.id}/Camera.004.png`,
                                `${OSS_BASE_URL}${project.id}/Camera.005.png`,
                                `${OSS_BASE_URL}${project.id}/Camera.006.png`,
                                `${OSS_BASE_URL}${project.id}/Camera.007.png`,
                                `${OSS_BASE_URL}${project.id}/Camera.png`,
                                `${OSS_BASE_URL}${project.id}/image1.jpeg`,
                                `${OSS_BASE_URL}${project.id}/image2.jpeg`,
                                `${OSS_BASE_URL}${project.id}/image3.jpeg`,
                                `${OSS_BASE_URL}${project.id}/image4.jpeg`,
                                `${OSS_BASE_URL}${project.id}/image5.jpeg`,
                                `${OSS_BASE_URL}${project.id}/image6.jpeg`,
                                `${OSS_BASE_URL}${project.id}/image7.jpeg`,
                                `${OSS_BASE_URL}${project.id}/image8.jpeg`,
                                `${OSS_BASE_URL}${project.id}/image9.jpeg`,
                                `${OSS_BASE_URL}${project.id}/image10.jpeg`
                            ];
                            
                            // 尝试下一个格式
                            let currentFormatIndex = 0;
                            let retryCount = 0;
                            const maxRetries = 3;
                            
                            function tryNextFormat() {
                                if (currentFormatIndex >= otherFormats.length) {
                                    // 所有格式都尝试失败，使用占位符
                                    this.src = 'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="400" height="225"%3E%3Crect width="400" height="225" fill="rgba(0, 0, 0, 0.3)"/%3E%3Ctext x="200" y="112" text-anchor="middle" fill="rgba(255, 255, 255, 0.5)" font-size="14"%3E图片加载失败%3C/text%3E%3C/svg%3E';
                                    this.style.opacity = '1';
                                    cardBody.style.opacity = '1';
                                    return;
                                }
                                
                                const nextFormat = otherFormats[currentFormatIndex];
                                console.log('尝试其他格式:', nextFormat);
                                this.src = nextFormat;
                                currentFormatIndex++;
                            }
                            
                            function retryLoad() {
                                if (retryCount >= maxRetries) {
                                    tryNextFormat.call(this);
                                    return;
                                }
                                
                                retryCount++;
                                console.log('重试加载图片:', this.src, '第', retryCount, '次');
                                this.src = this.src + '?t=' + new Date().getTime();
                            }
                            
                            // 尝试其他格式
                            tryNextFormat.call(this);
                            
                            // 重新设置onload和onerror事件
                            this.onload = function() {
                                console.log('图片加载成功:', this.src);
                                this.style.opacity = '1';
                                cardBody.style.opacity = '1';
                            };
                            
                            this.onerror = function() {
                                console.log('图片加载失败:', this.src);
                                if (retryCount < maxRetries) {
                                    retryLoad.call(this);
                                } else {
                                    tryNextFormat.call(this);
                                }
                            };
                        };
                    } else {
                        // 没有封面图片，使用占位符
                        image.src = 'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="400" height="225"%3E%3Crect width="400" height="225" fill="rgba(0, 0, 0, 0.3)"/%3E%3Ctext x="200" y="112" text-anchor="middle" fill="rgba(255, 255, 255, 0.5)" font-size="14"%3E无图片%3C/text%3E%3C/svg%3E';
                        image.style.opacity = '1';
                        cardBody.style.opacity = '1';
                    }
                
                // 延迟加载下一张，避免过快的递归调用
                currentLoadingIndex++;
                setTimeout(loadNextCard, 100); // 添加100ms延迟
            }
            
            // 开始加载当前页的卡片
            loadNextCard();
            
            // 加载保存的排序结果
            setTimeout(() => {
                loadSortOrder();
            }, 2000);
        }
        
        // 刷新项目数据（支持动态更新）
        function refreshProjects() {
            // 保存当前搜索状态
            const searchInput = document.getElementById('search-input');
            const searchTerm = searchInput ? searchInput.value : '';
            
            // 重新初始化项目数据
            initProjects();
            
            // 如果有搜索词，执行搜索
            if (searchTerm) {
                document.getElementById('search-input').value = searchTerm;
                searchProjects();
            } else {
                // 否则重新生成项目卡片
                generateProjectCards();
            }
        }
        
        // 页面加载完成后初始化项目数据
        window.onload = function() {
            refreshProjects();
        };
        
        // 检查项目更新的函数
        function checkProjectUpdates() {
            console.log('检查项目更新...');
            console.log('当前时间:', new Date().toLocaleString());
            
            // 尝试检测所有可能的项目目录，包括可能的新目录
            const possibleProjectDirs = [
                '今日家园',
                '八宝山街道永东北社区',
                '古城泰然体育健康中心',
                '复兴路24号社区长廊',
                '平谷刑侦办公通道',
                '永定路东里社区',
                '海能环境办公室',
                '海能环境办公楼',
                '翠西楼道空间文化墙打造',
                '金沟河东路社区居委会文化',
                '万寿路28号社区',
                '万寿路街道党群服务中心门头',
                '中农健康科技',
                '中组部老干部活动站',
                '太平路22号院',
                '学院路街道办事处大件垃圾堆放处',
                '曙光街道世纪城西区社区会客议事厅',
                '曙光街道远大园社区',
                '永东南社区',
                '永定路街道新就业群体友好驿站',
                '玉泉西里北社区文化墙',
                '玉泉西里西社区党群服务中心',
                '石景山区委党校运动健康中心',
                '金雅园社区文化墙' // 新添加的项目
            ];
            
            // 动态检测实际存在的项目
            const actualProjectDirs = [];
            let checkedCount = 0;
            
            possibleProjectDirs.forEach(dirName => {
                // 尝试加载项目的封面图片来检测项目是否存在
                const img = new Image();
                img.onload = function() {
                    // 图片加载成功，项目存在
                    if (!actualProjectDirs.includes(dirName)) {
                        actualProjectDirs.push(dirName);
                        console.log('检测到项目:', dirName);
                    }
                    checkedCount++;
                    checkComplete();
                };
                img.onerror = function() {
                    // 图片加载失败，尝试其他格式
                    const img2 = new Image();
                    img2.onload = function() {
                        if (!actualProjectDirs.includes(dirName)) {
                            actualProjectDirs.push(dirName);
                            console.log('检测到项目:', dirName);
                        }
                    };
                    img2.onerror = function() {
                        // 尝试更多可能的图片格式
                        const img3 = new Image();
                        img3.onload = function() {
                            if (!actualProjectDirs.includes(dirName)) {
                                actualProjectDirs.push(dirName);
                                console.log('检测到项目:', dirName);
                            }
                        };
                        img3.onerror = function() {
                            console.log('项目不存在:', dirName);
                        };
                        img3.src = `${OSS_BASE_URL}${dirName}/image1.png?t=${Date.now()}`;
                    };
                    img2.src = `${OSS_BASE_URL}${dirName}/场景 10_3.png?t=${Date.now()}`;
                    checkedCount++;
                    checkComplete();
                };
                img.src = `${OSS_BASE_URL}${dirName}/1.png?t=${Date.now()}`;
            });
            
            function checkComplete() {
                if (checkedCount === possibleProjectDirs.length) {
                    console.log('检测完成，实际项目数量:', actualProjectDirs.length);
                    // 与当前项目列表比较
                    compareProjectLists(actualProjectDirs);
                }
            }
        }
        
        // 比较项目列表的函数
        function compareProjectLists(newProjectDirs) {
            // 获取当前项目列表
            const currentProjectDirs = projects.map(project => project.id);
            
            console.log('检测到的项目数量:', newProjectDirs.length);
            console.log('当前显示的项目数量:', currentProjectDirs.length);
            
            // 排序两个列表以便比较
            newProjectDirs.sort();
            currentProjectDirs.sort();
            
            // 比较两个列表是否相同
            let isUpdated = false;
            if (newProjectDirs.length !== currentProjectDirs.length) {
                console.log('项目数量不同，需要更新');
                isUpdated = true;
            } else {
                // 只比较前10个项目，避免不必要的比较
                const compareCount = Math.min(newProjectDirs.length, 10);
                for (let i = 0; i < compareCount; i++) {
                    if (newProjectDirs[i] !== currentProjectDirs[i]) {
                        console.log('项目列表不同，需要更新');
                        isUpdated = true;
                        break;
                    }
                }
            }
            
            // 如果项目列表有更新，刷新页面内容
            if (isUpdated) {
                console.log('项目文件夹已更新，刷新页面内容...');
                refreshProjects();
            } else {
                console.log('项目文件夹未更新');
            }
        }



        // 显示项目详情
        function showProjectDetails(projectId) {
            const project = projects.find(p => p.id === projectId);
            if (!project) return;
            
            currentProjectId = projectId;
            projectImagesList = projectImages[projectId] || [];
            currentImageIndex = 0;
            currentView = 'grid'; // 默认使用网格视图
            
            // 更新模态框标题
            document.getElementById('projectModalLabel').textContent = project.title;
            
            // 更新图片容器
            const imageContainer = document.getElementById('image-scroll-container');
            imageContainer.innerHTML = '';
            
            // 创建视图切换按钮
            const viewToggle = document.createElement('div');
            viewToggle.className = 'view-toggle';
            
            const gridBtn = document.createElement('button');
            gridBtn.className = 'toggle-btn active';
            gridBtn.textContent = '网格视图';
            gridBtn.onclick = function() {
                switchToGridView();
            };
            
            const singleBtn = document.createElement('button');
            singleBtn.className = 'toggle-btn';
            singleBtn.textContent = '单张视图';
            singleBtn.onclick = function() {
                switchToSingleView();
            };
            
            viewToggle.appendChild(gridBtn);
            viewToggle.appendChild(singleBtn);
            
            imageContainer.appendChild(viewToggle);
            
            // 创建初始视图（网格视图）
            createGridView();
            
            // 重置缩放状态
            resetZoom();
            
            // 显示模态框
            const modal = new bootstrap.Modal(document.getElementById('projectModal'));
            modal.show();
        }

        // 创建网格视图
        function createGridView() {
            const imageContainer = document.getElementById('image-scroll-container');
            
            // 移除现有内容，保留视图切换按钮
            const viewToggle = imageContainer.querySelector('.view-toggle');
            imageContainer.innerHTML = '';
            if (viewToggle) {
                imageContainer.appendChild(viewToggle);
            }
            
            // 更新视图切换按钮状态
            updateViewToggleButtons('grid');
            
            // 创建网格容器
            const gridContainer = document.createElement('div');
            gridContainer.className = 'grid-view';
            
            // 存储所有图片元素和相关信息
            const imageElements = [];
            
            // 创建所有图片元素，但先不加载
            projectImagesList.forEach((img, index) => {
                const gridItem = document.createElement('div');
                gridItem.className = 'grid-image-item';
                
                const gridImage = document.createElement('img');
                gridImage.className = 'grid-image';
                gridImage.draggable = 'true';
                gridImage.style.cursor = 'grab';
                // 使用透明占位符
                gridImage.src = 'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="400" height="300"%3E%3Crect width="400" height="300" fill="rgba(0, 0, 0, 0.1)"/%3E%3C/svg%3E';
                gridImage.alt = `${currentProjectId} - 图片 ${index + 1}`;
                gridImage.style.opacity = '0';
                gridImage.style.transition = 'opacity 0.5s ease';
                
                // 存储图片源URL
                const imageSrc = img;
                
                gridItem.appendChild(gridImage);
                
                // 点击图片切换到单张视图并显示该图片
                gridImage.onclick = function(e) {
                    // 阻止事件冒泡，确保点击图片时不会触发其他元素的事件
                    e.stopPropagation();
                    currentImageIndex = index;
                    switchToSingleView();
                };
                
                gridContainer.appendChild(gridItem);
                
                // 存储图片元素和相关信息
                imageElements.push({
                    image: gridImage,
                    src: img,
                    index: index,
                    gridItem: gridItem
                });
            });
            
            imageContainer.appendChild(gridContainer);
            currentView = 'grid';
            
            // 实现顺序加载
            let currentLoadingIndex = 0;
            
            function loadNextImage() {
                if (currentLoadingIndex >= imageElements.length) {
                    return; // 所有图片都已加载
                }
                
                const imgElement = imageElements[currentLoadingIndex];
                const { image, loadingContainer, src } = imgElement;
                
                // 加载图片
                image.src = src;
                
                // 图片加载完成后显示并加载下一张
                image.onload = function() {
                    this.style.opacity = '1';
                    
                    // 确保图片可拖拽
                    this.draggable = 'true';
                    this.style.cursor = 'grab';
                    
                    // 确保图片元素可以接收鼠标事件
                    this.style.pointerEvents = 'auto';
                    
                    // 移除旧的事件监听器
                    this.removeEventListener('dragstart', dragStartHandler);
                    
                    // 定义新的拖拽事件处理函数
                    function dragStartHandler(e) {
                        // 设置拖拽效果
                        e.dataTransfer.effectAllowed = 'copy';
                        
                        // 设置多种格式的拖拽数据
                        e.dataTransfer.setData('text/uri-list', this.src);
                        e.dataTransfer.setData('text/plain', this.src);
                        
                        // 设置拖拽预览
                        e.dataTransfer.setDragImage(this, this.width / 2, this.height / 2);
                        
                        // 添加拖拽动画效果
                        this.style.opacity = '0.5';
                    }
                    
                    // 添加事件监听器
                    this.addEventListener('dragstart', dragStartHandler.bind(this));
                    
                    this.addEventListener('dragend', function(e) {
                        // 拖拽结束后恢复样式
                        this.style.opacity = '1';
                    });
                    
                    // 延迟一下再加载下一张，让用户看到加载顺序
                    setTimeout(() => {
                        currentLoadingIndex++;
                        loadNextImage();
                    }, 300); // 300ms延迟，可根据需要调整
                };
                
                // 图片加载失败的处理
                image.onerror = function() {
                    console.error('图片加载失败:', src);
                    
                    // 使用占位符图片
                    this.src = 'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="400" height="300"%3E%3Crect width="400" height="300" fill="rgba(0, 0, 0, 0.3)"/%3E%3Ctext x="200" y="150" text-anchor="middle" fill="rgba(255, 255, 255, 0.5)" font-size="14"%3E图片加载失败%3C/text%3E%3C/svg%3E';
                    this.style.opacity = '1';
                    
                    // 继续加载下一张
                    setTimeout(() => {
                        currentLoadingIndex++;
                        loadNextImage();
                    }, 300); // 与成功加载时的延迟保持一致
                };
            }
            
            // 开始顺序加载图片
            loadNextImage();
        }

        // 切换到网格视图
        function switchToGridView() {
            createGridView();
        }

        // 切换到单张视图
        function switchToSingleView() {
            const imageContainer = document.getElementById('image-scroll-container');
            
            // 移除现有内容，保留视图切换按钮
            const viewToggle = imageContainer.querySelector('.view-toggle');
            imageContainer.innerHTML = '';
            if (viewToggle) {
                imageContainer.appendChild(viewToggle);
            }
            
            // 更新视图切换按钮状态
            updateViewToggleButtons('single');
            
            // 创建单张视图容器
            const singleContainer = document.createElement('div');
            singleContainer.className = 'single-view';
            
            // 创建主图片元素
            const mainImage = document.createElement('img');
            mainImage.id = 'mainImage';
            mainImage.className = 'main-image';
            mainImage.alt = `${currentProjectId} - 图片 ${currentImageIndex + 1}`;
            
            // 创建图片信息
            const infoContainer = document.createElement('div');
            infoContainer.className = 'image-info';
            infoContainer.id = 'imageInfo';
            
            // 创建控制按钮
            const controlsContainer = document.createElement('div');
            controlsContainer.className = 'image-controls';
            
            const prevBtn = document.createElement('button');
            prevBtn.className = 'control-btn';
            prevBtn.textContent = '上一张';
            prevBtn.onclick = showPrevImage;
            
            const nextBtn = document.createElement('button');
            nextBtn.className = 'control-btn';
            nextBtn.textContent = '下一张';
            nextBtn.onclick = showNextImage;
            
            const zoomInBtn = document.createElement('button');
            zoomInBtn.className = 'control-btn';
            zoomInBtn.textContent = '放大';
            zoomInBtn.onclick = zoomIn;
            
            const zoomOutBtn = document.createElement('button');
            zoomOutBtn.className = 'control-btn';
            zoomOutBtn.textContent = '缩小';
            zoomOutBtn.onclick = zoomOut;
            
            controlsContainer.appendChild(prevBtn);
            controlsContainer.appendChild(nextBtn);
            controlsContainer.appendChild(zoomInBtn);
            controlsContainer.appendChild(zoomOutBtn);
            
            // 添加元素到容器
            singleContainer.appendChild(mainImage);
            singleContainer.appendChild(infoContainer);
            singleContainer.appendChild(controlsContainer);
            
            imageContainer.appendChild(singleContainer);
            
            // 加载当前图片
            loadImage(currentImageIndex);
            
            currentView = 'single';
        }

        // 更新视图切换按钮状态
        function updateViewToggleButtons(activeView) {
            const toggleButtons = document.querySelectorAll('.toggle-btn');
            toggleButtons.forEach(btn => {
                btn.classList.remove('active');
            });
            
            if (activeView === 'grid') {
                toggleButtons[0].classList.add('active');
            } else {
                toggleButtons[1].classList.add('active');
            }
        }

        // 加载图片
        function loadImage(index) {
            if (index < 0 || index >= projectImagesList.length) return;
            
            currentImageIndex = index;
            const mainImage = document.getElementById('mainImage');
            const imageInfo = document.getElementById('imageInfo');
            
            if (mainImage && imageInfo) {
                // 显示加载中状态
                mainImage.src = 'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="200" height="200"%3E%3Crect width="200" height="200" fill="%23333"/%3E%3Ctext x="100" y="100" text-anchor="middle" fill="%23666" font-size="16"%3E加载中...%3C/text%3E%3C/svg%3E';
                mainImage.alt = `${currentProjectId} - 图片 ${index + 1}`;
                
                imageInfo.textContent = `图片 ${index + 1} / ${projectImagesList.length}`;
                
                // 预加载下一张和上一张图片
                if (index > 0) {
                    const prevImg = new Image();
                    prevImg.src = projectImagesList[index - 1];
                }
                if (index < projectImagesList.length - 1) {
                    const nextImg = new Image();
                    nextImg.src = projectImagesList[index + 1];
                }
                
                // 加载当前图片
                const img = new Image();
                img.onload = function() {
                    mainImage.src = this.src;
                    
                    // 图片加载成功时的处理
                    mainImage.addEventListener('wheel', handleWheel);
                    mainImage.addEventListener('mousedown', startDrag);
                    mainImage.addEventListener('touchstart', startDragTouch);
                    
                    // 添加点击缩放事件
                    mainImage.addEventListener('click', function() {
                        if (currentZoom > 1) {
                            resetZoom();
                        } else {
                            currentZoom = 2;
                            updatePosition();
                            this.classList.add('zoomed');
                        }
                    });
                    
                    // 添加拖拽功能
                    mainImage.draggable = 'true';
                    mainImage.addEventListener('dragstart', function(e) {
                        e.dataTransfer.setData('text/plain', this.src);
                        e.dataTransfer.effectAllowed = 'copy';
                    });
                };
                img.src = projectImagesList[index];
            }
        }

        // 显示上一张图片
        function showPrevImage() {
            if (currentImageIndex > 0) {
                loadImage(currentImageIndex - 1);
            }
        }

        // 显示下一张图片
        function showNextImage() {
            if (currentImageIndex < projectImagesList.length - 1) {
                loadImage(currentImageIndex + 1);
            }
        }

        // 处理鼠标滚轮事件（缩放）
        function handleWheel(e) {
            e.preventDefault();
            currentImage = e.target;
            
            const delta = e.deltaY > 0 ? -0.1 : 0.1;
            updateZoom(delta);
        }

        // 开始拖动（鼠标）
        function startDrag(e) {
            if (currentZoom <= 1) return;
            
            isDragging = true;
            startX = e.clientX - translateX;
            startY = e.clientY - translateY;
            currentImage = e.target;
            
            document.addEventListener('mousemove', drag);
            document.addEventListener('mouseup', stopDrag);
        }

        // 开始拖动（触摸）
        function startDragTouch(e) {
            if (currentZoom <= 1) return;
            
            isDragging = true;
            startX = e.touches[0].clientX - translateX;
            startY = e.touches[0].clientY - translateY;
            currentImage = e.target;
            
            document.addEventListener('touchmove', dragTouch);
            document.addEventListener('touchend', stopDrag);
        }

        // 拖动（鼠标）
        function drag(e) {
            if (!isDragging) return;
            e.preventDefault();
            
            translateX = e.clientX - startX;
            translateY = e.clientY - startY;
            updatePosition();
        }

        // 拖动（触摸）
        function dragTouch(e) {
            if (!isDragging) return;
            e.preventDefault();
            
            translateX = e.touches[0].clientX - startX;
            translateY = e.touches[0].clientY - startY;
            updatePosition();
        }

        // 停止拖动
        function stopDrag() {
            isDragging = false;
            document.removeEventListener('mousemove', drag);
            document.removeEventListener('touchmove', dragTouch);
            document.removeEventListener('mouseup', stopDrag);
            document.removeEventListener('touchend', stopDrag);
        }

        // 缩放控制
        function zoomIn() {
            // 检查当前视图
            if (currentView === 'single') {
                currentImage = document.getElementById('mainImage');
                updateZoom(0.1);
            } else if (currentView === 'grid') {
                // 在网格视图中，放大所有图片
                const gridImages = document.querySelectorAll('.grid-image');
                gridImages.forEach(img => {
                    const currentScale = parseFloat(img.style.transform.replace('scale(', '')) || 1;
                    const newScale = Math.min(currentScale + 0.1, 3);
                    img.style.transform = `scale(${newScale})`;
                });
            }
        }

        function zoomOut() {
            // 检查当前视图
            if (currentView === 'single') {
                currentImage = document.getElementById('mainImage');
                updateZoom(-0.1);
            } else if (currentView === 'grid') {
                // 在网格视图中，缩小所有图片
                const gridImages = document.querySelectorAll('.grid-image');
                gridImages.forEach(img => {
                    const currentScale = parseFloat(img.style.transform.replace('scale(', '')) || 1;
                    const newScale = Math.max(currentScale - 0.1, 0.5);
                    img.style.transform = `scale(${newScale})`;
                });
            }
        }

        function resetZoom() {
            currentZoom = 1;
            translateX = 0;
            translateY = 0;
            
            // 检查当前视图
            if (currentView === 'single') {
                // 重置主图片的缩放和位置
                const mainImage = document.getElementById('mainImage');
                if (mainImage) {
                    mainImage.style.transform = 'scale(1) translate(0, 0)';
                }
            } else if (currentView === 'grid') {
                // 在网格视图中，重置所有图片的缩放
                const gridImages = document.querySelectorAll('.grid-image');
                gridImages.forEach(img => {
                    img.style.transform = 'scale(1)';
                });
            }
        }

        // 更新缩放
        function updateZoom(delta) {
            const newZoom = currentZoom + delta;
            
            // 限制缩放范围
            if (newZoom < 0.1 || newZoom > 5) return;
            
            currentZoom = newZoom;
            updatePosition();
        }

        // 更新位置
        function updatePosition() {
            if (!currentImage) return;
            
            currentImage.style.transform = `scale(${currentZoom}) translate(${translateX}px, ${translateY}px)`;
            
            // 根据缩放状态更新鼠标样式
            if (currentZoom > 1) {
                currentImage.classList.add('zoomed');
            } else {
                currentImage.classList.remove('zoomed');
            }
        }

        // 上下滚动函数（保留以兼容现有代码）
        function scrollToPrev() {
            showPrevImage();
        }

        function scrollToNext() {
            showNextImage();
        }

        // 触摸事件支持
        document.addEventListener('touchstart', function(e) {
            touchStartX = e.changedTouches[0].screenX;
            touchStartY = e.changedTouches[0].screenY;
        }, false);
        
        document.addEventListener('touchend', function(e) {
            touchEndX = e.changedTouches[0].screenX;
            touchEndY = e.changedTouches[0].screenY;
            handleSwipe();
        }, false);
        
        // 触摸事件变量
        let touchStartX = 0;
        let touchStartY = 0;
        let touchEndX = 0;
        let touchEndY = 0;
        
        function handleSwipe() {
            const diffX = touchEndX - touchStartX;
            const diffY = touchEndY - touchStartY;
            
            // 水平滑动
            if (Math.abs(diffX) > Math.abs(diffY)) {
                if (Math.abs(diffX) > 100) {
                    if (diffX > 0) {
                        // 右滑
                        console.log('右滑');
                        if (currentView === 'single' && currentImageIndex > 0) {
                            showPrevImage();
                        }
                    } else {
                        // 左滑
                        console.log('左滑');
                        if (currentView === 'single' && currentImageIndex < projectImagesList.length - 1) {
                            showNextImage();
                        }
                    }
                }
            } else {
                // 垂直滑动
                if (Math.abs(diffY) > 100) {
                    if (diffY > 0) {
                        // 下滑
                        console.log('下滑');
                    } else {
                        // 上滑
                        console.log('上滑');
                    }
                }
            }
        }
        
        // 为图片添加触摸缩放支持
        function addPinchZoom(element) {
            let startScale = 1;
            let lastTouchDistance = 0;
            
            element.addEventListener('touchstart', function(e) {
                if (e.touches.length === 2) {
                    e.preventDefault();
                    lastTouchDistance = getDistance(e.touches[0], e.touches[1]);
                    startScale = currentZoom;
                }
            });
            
            element.addEventListener('touchmove', function(e) {
                if (e.touches.length === 2) {
                    e.preventDefault();
                    const distance = getDistance(e.touches[0], e.touches[1]);
                    const scale = (distance / lastTouchDistance) * startScale;
                    currentZoom = Math.max(0.5, Math.min(scale, 5));
                    
                    if (currentView === 'single') {
                        currentImage = this;
                        updatePosition();
                    }
                }
            });
        }
        
        function getDistance(touch1, touch2) {
            return Math.hypot(
                touch2.clientX - touch1.clientX,
                touch2.clientY - touch1.clientY
            );
        }
        
        // 为所有图片添加触摸缩放支持
        document.addEventListener('DOMContentLoaded', function() {
            const images = document.querySelectorAll('.project-image, .main-image, .grid-image');
            images.forEach(img => {
                addPinchZoom(img);
            });
        });

        // 页面加载完成后生成项目卡片
        // 注意：window.onload已经在上面定义过了，这里不再重复定义
    </script>
</body>
</html>
